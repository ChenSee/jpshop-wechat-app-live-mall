(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4dbb17f5"],{"2bdd":function(t,e,a){},"98e1":function(t,e,a){"use strict";a.d(e,"g",(function(){return s})),a.d(e,"n",(function(){return n})),a.d(e,"p",(function(){return o})),a.d(e,"o",(function(){return c})),a.d(e,"c",(function(){return r})),a.d(e,"h",(function(){return u})),a.d(e,"k",(function(){return l})),a.d(e,"a",(function(){return p})),a.d(e,"f",(function(){return d})),a.d(e,"j",(function(){return m})),a.d(e,"m",(function(){return f})),a.d(e,"d",(function(){return v})),a.d(e,"e",(function(){return h})),a.d(e,"i",(function(){return g})),a.d(e,"l",(function(){return _})),a.d(e,"b",(function(){return y}));var i=a("b775");function s(t){return Object(i["a"])({url:"/merchantShopUsers",method:"get",params:t})}function n(t){var e=t.id;return delete t.id,Object(i["a"])({url:"/merchantShopUsers/"+e,method:"put",data:t})}function o(t){return Object(i["a"])({url:"/merchantVipPlugin",method:"get",params:t})}function c(t){var e=t.id;return delete t.id,Object(i["a"])({url:"/merchantVipPlugin/"+e,method:"put",data:t})}function r(t){return Object(i["a"])({url:"/vips",method:"get",params:t})}function u(t){return Object(i["a"])({url:"/vips",method:"post",data:t})}function l(t){var e=t.id;return delete t.id,Object(i["a"])({url:"/vips/"+e,method:"put",data:t})}function p(t){var e=t.id;return delete t.id,Object(i["a"])({url:"/vips/"+e,method:"delete",data:t})}function d(t){return Object(i["a"])({url:"/vipConfig",method:"get",params:t})}function m(t){return Object(i["a"])({url:"/vipConfig",method:"post",data:t})}function f(t){var e=t.id;return delete t.id,Object(i["a"])({url:"/vipConfig/"+e,method:"put",data:t})}function v(t){return Object(i["a"])({url:"/shopVouTypes",method:"get",params:t})}function h(t){return Object(i["a"])({url:"/unpaidVips",method:"get",params:t})}function g(t){return Object(i["a"])({url:"/unpaidVips",method:"post",data:t})}function _(t){var e=t.id;return delete t.id,Object(i["a"])({url:"/unpaidVips/"+e,method:"put",data:t})}function y(t){var e=t.id;return delete t.id,Object(i["a"])({url:"/unpaidVips/"+e,method:"delete",data:t})}},a44e:function(t,e,a){"use strict";var i=a("2bdd"),s=a.n(i);s.a},de96:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"vip-pay-container"},[a("el-row",{staticClass:"vip-pay-row"},[a("el-col",{staticClass:"vip-pay-row-col",staticStyle:{"text-align":"left","padding-left":"15px"},attrs:{span:8}},[a("el-button",{staticStyle:{padding:"8px 30px"},attrs:{type:"primary",size:"small"},on:{click:function(e){t.disVipPanel=!0,t.isAdd=!0,t.rest()}}},[t._v("新 增")]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"30px"},attrs:{type:"primary",plain:"",size:"small"},on:{click:function(e){t.disVipConfig=!0}}},[t._v("会员卡配置")])],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("span",{staticStyle:{padding:"0 10px"}},[t._v("会员总开关")]),t._v(" "),a("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:t.putVipSwitch},model:{value:t.switchData.is_open,callback:function(e){t.$set(t.switchData,"is_open",e)},expression:"switchData.is_open"}})],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-input",{staticStyle:{"max-width":"240px"},attrs:{placeholder:"请输入名称",size:"small"},model:{value:t.searchName,callback:function(e){t.searchName=e},expression:"searchName"}},[a("el-button",{staticClass:"search-button",attrs:{slot:"suffix",type:"text",size:"small"},on:{click:t.search},slot:"suffix"},[a("i",{staticClass:"el-icon-search"})])],1)],1)],1),t._v(" "),a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.pagVipList,stripe:""}},[a("el-table-column",{attrs:{prop:"name",label:"会员卡名称",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"money",label:"会员卡金额",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"validity_time_text",label:"有效时间",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"pay_count",label:"购买次数",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:function(a){return t.putVipStatus(e.row)}},model:{value:e.row.status,callback:function(a){t.$set(e.row,"status",a)},expression:"scope.row.status"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"action-button",attrs:{type:"text"},on:{click:function(a){return t.eidt(e.row)}}},[a("i",{staticClass:"el-icon-edit"})]),t._v(" "),a("el-button",{staticClass:"action-button",attrs:{type:"text"},on:{click:function(a){return t.del(e.row)}}},[a("svg-icon",{attrs:{"icon-class":"shanchu"}})],1)]}}])})],1)],1),t._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"15px 15px"}},[a("el-pagination",{staticClass:"page",attrs:{background:"",layout:"total, prev, pager, next, jumper",total:t.count,"page-size":10,"current-page":t.page},on:{"size-change":t.changePage,"current-change":t.changePage}})],1),t._v(" "),a("el-dialog",{attrs:{visible:t.disVipPanel,width:"30%",title:t.isAdd?"新增":"修改"},on:{"update:visible":function(e){t.disVipPanel=e}}},[t.disVipPanel?a("vip-panel",{attrs:{vipData:t.vipData,isAdd:t.isAdd},on:{success:function(e){t.disVipPanel=!1,t.getPayVipList()}}}):t._e()],1),t._v(" "),a("el-dialog",{attrs:{visible:t.disVipConfig,width:"30%",title:"会员卡配置"},on:{"update:visible":function(e){t.disVipConfig=e}}},[a("vip-config",{on:{configSuccess:function(e){t.disVipConfig=!1}}})],1)],1)},s=[],n=(a("ac6a"),a("98e1")),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{ref:"vipform",attrs:{model:t.vipData,rules:t.vipRules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"会员卡名称",prop:"name"}},[a("el-input",{staticStyle:{"max-width":"70%"},attrs:{placeholder:"请输入会员卡名称",size:"small"},model:{value:t.vipData.name,callback:function(e){t.$set(t.vipData,"name",e)},expression:"vipData.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"会员卡金额",prop:"money"}},[a("el-input",{staticStyle:{"max-width":"70%"},attrs:{placeholder:"请输入会员卡金额",size:"small"},model:{value:t.vipData.money,callback:function(e){t.$set(t.vipData,"money",e)},expression:"vipData.money"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"有效时间"}},[a("el-select",{staticStyle:{"max-width":"70"},attrs:{placeholder:"请选择有效时间",size:"small"},model:{value:t.vipData.validity_time,callback:function(e){t.$set(t.vipData,"validity_time",e)},expression:"vipData.validity_time"}},[a("el-option",{attrs:{label:"七天",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"一个月",value:"2"}}),t._v(" "),a("el-option",{attrs:{label:"三个月",value:"3"}}),t._v(" "),a("el-option",{attrs:{label:"一年",value:"4"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"购买次数"}},[a("el-input",{staticStyle:{"max-width":"70%"},attrs:{placeholder:"请输入购买次数",size:"small"},model:{value:t.vipData.pay_count,callback:function(e){t.$set(t.vipData,"pay_count",e)},expression:"vipData.pay_count"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-switch",{attrs:{"active-color":"#13ce66"},model:{value:t.vipData.status,callback:function(e){t.$set(t.vipData,"status",e)},expression:"vipData.status"}})],1)],1),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{staticStyle:{padding:"8px 30px"},attrs:{type:"primary",size:"small"},on:{click:t.submit}},[t._v("提 交")])],1)],1)},c=[],r=(a("7f7f"),a("4360")),u={name:"vipPanel",props:{isAdd:{type:Boolean,required:!0,default:!0},vipData:{type:Object,default:function(){return{key:r["a"].state.app.activeApp.saa_key,name:"",money:"",validity_time:"1",pay_count:"",status:!0}}}},data:function(){return{vipRules:{name:[{required:!0,message:"请输入会员卡名称",trigger:"blur"}],money:[{required:!0,message:"请输入会员卡金额",trigger:"blur"}]}}},methods:{submit:function(){var t=this;this.$refs.vipform.validate((function(e){if(e)if(t.isAdd)t.vipData.status=t.vipData.status?"1":"0",Object(n["h"])(t.vipData).then((function(e){200===e.status?(t.$emit("success"),t.$message.success("添加成功！")):t.$message.error(e.message)}));else{var a={key:t.$store.state.app.activeApp.saa_key,id:t.vipData.id,name:t.vipData.name,money:t.vipData.money,validity_time:t.vipData.validity_time,pay_count:t.vipData.pay_count,status:t.vipData.status?"1":"0"};Object(n["k"])(a).then((function(e){200===e.status?(t.$emit("success"),t.$message.success("修改成功！")):t.$message.error(e.message)}))}}))}}},l=u,p=a("2877"),d=Object(p["a"])(l,o,c,!1,null,null,null),m=d.exports,f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{ref:"configform",attrs:{model:t.configData,rules:t.configRules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"优惠比列",prop:"ratio"}},[a("el-input",{staticStyle:{"max-width":"70%"},attrs:{placeholder:"请输入优惠比例",size:"small"},model:{value:t.configData.discount_ratio,callback:function(e){t.$set(t.configData,"discount_ratio",e)},expression:"configData.discount_ratio"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"赠送优惠卷数量",prop:"count"}},[a("el-input",{staticStyle:{"max-width":"70%"},attrs:{placeholder:"请输入赠送数量",size:"small"},model:{value:t.configData.voucher_count,callback:function(e){t.$set(t.configData,"voucher_count",e)},expression:"configData.voucher_count"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"代金券类型"}},[a("el-select",{staticStyle:{"max-width":"70"},attrs:{placeholder:"请选择有效时间",size:"small"},model:{value:t.configData.voucher_type_id,callback:function(e){t.$set(t.configData,"voucher_type_id",e)},expression:"configData.voucher_type_id"}},t._l(t.shopVouList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"获取积分倍数",prop:"score"}},[a("el-input",{staticStyle:{"max-width":"70%"},attrs:{placeholder:"请输入积分倍数",size:"small"},model:{value:t.configData.score_times,callback:function(e){t.$set(t.configData,"score_times",e)},expression:"configData.score_times"}})],1)],1),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{staticStyle:{padding:"8px 30px"},attrs:{type:"primary",size:"small"},on:{click:t.submit}},[t._v("提 交")])],1)],1)},v=[],h={name:"vipConfig",data:function(){return{configData:{key:this.$store.state.app.activeApp.saa_key,discount_ratio:"",voucher_count:"",score_times:"",voucher_type_id:"",status:1},shopVouList:[],isAdd:!0,configRules:{ratio:[{required:!1,message:"请输入优惠比例",trigger:"blur"}],count:[{required:!1,message:"请输入代金券数量",trigger:"blur"}],score:[{required:!1,message:"请输入会员积分倍数",trigger:"blur"}]}}},watch:{shopVouList:function(t){t.length>0&&(this.configData.voucher_type_id=t[0].id)}},mounted:function(){this.getVipConfig(),this.getShopVouType()},methods:{submit:function(){var t=this;this.$refs.configform.validate((function(e){if(e)if(t.isAdd){var a={key:t.$store.state.app.activeApp.saa_key,discount_ratio:t.configData.discount_ratio,voucher_count:t.configData.voucher_count,voucher_type_id:t.configData.voucher_type_id,score_times:t.configData.score_times};Object(n["j"])(a).then((function(e){200===e.status?(t.$emit("configSuccess"),t.$message.success("添加成功！")):t.$message.error(e.message)}))}else{var i={key:t.$store.state.app.activeApp.saa_key,id:t.configData.id,discount_ratio:t.configData.discount_ratio,voucher_count:t.configData.voucher_count,voucher_type_id:t.configData.voucher_type_id,score_times:t.configData.score_times};Object(n["m"])(i).then((function(e){200===e.status?(t.$emit("configSuccess"),t.$message.success("修改成功！")):t.$message.error(e.message)}))}else console.log(t.configData)}))},getVipConfig:function(){var t=this;Object(n["f"])({key:this.$store.state.app.activeApp.saa_key}).then((function(e){200===e.status?(t.configData=e.data,t.isAdd=!1):204===e.status?(t.configData={key:t.$store.state.app.activeApp.saa_key,discount_ratio:"",voucher_count:"",score_times:"",voucher_type_id:"",status:!0},t.isAdd=!0):t.$message.error(e.message)}))},getShopVouType:function(){var t=this;Object(n["d"])({key:this.$store.state.app.activeApp.saa_key,type:"1"}).then((function(e){200===e.status?t.shopVouList=e.data:t.$message.error(e.message)}))}}},g=h,_=Object(p["a"])(g,f,v,!1,null,null,null),y=_.exports,b={name:"vipPay",components:{vipPanel:m,vipConfig:y},data:function(){return{switchData:{},page:1,count:1,searchName:"",pagVipList:[],disVipPanel:!1,isAdd:!0,disVipConfig:!1,vipData:{key:this.$store.state.app.activeApp.saa_key,name:"",money:"",validity_time:"1",pay_count:"",status:!0}}},mounted:function(){this.vipSwitch(),this.getPayVipList()},methods:{eidt:function(t){this.isAdd=!1,this.vipData=t,this.disVipPanel=!0},putVipStatus:function(t){var e=this,a={key:this.$store.state.app.activeApp.saa_key,id:t.id,status:t.status?"1":"0"};Object(n["k"])(a).then((function(t){200===t.status?(e.$message.success("修改成功！"),e.getPayVipList()):e.$message.error(t.message)}))},getPayVipList:function(){var t=this,e={key:this.$store.state.app.activeApp.saa_key,searchName:this.searchName,page:this.page,limit:10};Object(n["c"])(e).then((function(e){200===e.status?(t.pagVipList=e.data,t.pagVipList.forEach((function(t){return t.status="1"===t.status})),t.count=parseInt(e.count)):204===e.status?(t.pagVipList=[],t.count=1):t.$message.error(e.message)}))},vipSwitch:function(){var t=this,e={key:this.$store.state.app.activeApp.saa_key,english_name:"Vip_payment"};Object(n["p"])(e).then((function(e){200===e.status?(t.switchData=e.data,t.switchData.is_open="1"===t.switchData.is_open):204===e.status?t.switchData={}:t.$message.error(e.message)}))},putVipSwitch:function(){var t=this;if(this.switchData.is_open)this.$confirm("开启付费会员，积分会员将自动关闭，确定开启吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e={key:t.$store.state.app.activeApp.saa_key,english_name:"Vip_payment",is_open:t.switchData.is_open?"1":"0",id:t.switchData.id};Object(n["o"])(e).then((function(e){200===e.status?t.$message.success("修改成功！"):t.$message.error(e.message)}))})).catch((function(){t.switchData.is_open=!1}));else{var e={key:this.$store.state.app.activeApp.saa_key,english_name:"Vip_payment",is_open:this.switchData.is_open?"1":"0",id:this.switchData.id};Object(n["o"])(e).then((function(e){200===e.status?t.$message.success("修改成功！"):t.$message.error(e.message)}))}},changePage:function(t){this.page=t,this.getPayVipList()},search:function(){var t=this,e={key:this.$store.state.app.activeApp.saa_key,page:1,limit:10,searchName:this.searchName};Object(n["c"])(e).then((function(e){200===e.status?(t.pagVipList=e.data,t.pagVipList.forEach((function(t){return t.status="1"===t.status})),t.count=parseInt(e.count)):204===e.status?(t.pagVipList=[],t.count=1):t.$message.error(e.message)}))},del:function(t){var e=this,a={key:this.$store.state.app.activeApp.saa_key,id:t.id};Object(n["a"])(a).then((function(t){200===t.status?(e.getPayVipList(),e.$message.success("删除成功！")):e.$message.error(t.message)}))},rest:function(){this.vipData={key:this.$store.state.app.activeApp.saa_key,name:"",money:"",validity_time:"1",pay_count:"",status:!0}}}},D=b,k=(a("a44e"),Object(p["a"])(D,i,s,!1,null,"06d9302a",null));e["default"]=k.exports}}]);