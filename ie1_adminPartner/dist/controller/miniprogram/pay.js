/** layuiAdmin.pro-v1.0.0-beta7 LPPL License By http://www.layui.com/admin/ */
 ;layui.define(function(e){layui.use(["jquery","form","admin","setter"],function(){var e,a,t=layui.$,r=layui.form,n=layui.admin,s=layui.setter,i=s.baseUrl,o=s.successMsg,l=s.errorMsg,d=s.timeOutCode,u=s.timeOutMsg,c={"Access-Token":layui.data(s.tableName).access_token},m=1,g={shade:.3},p=sessionStorage.getItem("saa_key"),y="wechat";r.render();var f="";t("#addHeadImg").change(function(){var e=this.files[0];if(window.FileReader){var a=new FileReader;a.readAsDataURL(e),a.onloadend=function(e){f=e.target.result,t("#headImg").attr("src",e.target.result)}}e=null});var h="";t("#addQrCodeImg").change(function(){var e=this.files[0];if(window.FileReader){var a=new FileReader;a.readAsDataURL(e),a.onloadend=function(e){h=e.target.result,t("#qrCodeImg").attr("src",e.target.result)}}e=null});var v=i+"/merchantConfig?key="+p+"&config_type="+y;t.ajax({url:v,type:"get",async:!1,headers:c,beforeSend:function(){a=layer.load(m,g)},success:function(e){return layer.close(a),e.status==d?(layer.msg(u),n.exit(),!1):200!=e.status?(layer.msg(e.message),!1):(t("input[name=name]").val(e.data.name),t("select[name=type]").val(e.data.type),t("input[name=AppID]").val(e.data.AppID),t("input[name=AppSecret]").val(e.data.AppSecret),t("#headImg").attr("src",i+"/"+e.data.headImg),t("#qrCodeImg").attr("src",i+"/"+e.data.qrCodeImg),void r.render())},error:function(){layer.msg(l),layer.close(a)}}),r.on("submit(next)",function(){t(".second_page").show(),t(".first_page").hide()}),r.on("submit(previous)",function(){t(".second_page").hide(),t(".first_page").show()}),r.on("submit(sub)",function(r){console.log(r);var s={name:r.field.name,type:r.field.type,AppID:r.field.AppID,AppSecret:r.field.AppSecret,headImg:f,qrCodeImg:h,config_type:y,key:p};t.ajax({url:v,type:"put",async:!1,data:s,headers:c,beforeSend:function(){a=layer.load(m,g)},success:function(t){return layer.close(a),t.status==d?(layer.msg(u),n.exit(),!1):200!=t.status?(layer.msg(t.message),!1):(layer.msg(o.put),layer.close(e),void location.reload())},error:function(){layer.msg(l),layer.close(a)}})})}),e("miniprogram/pay",{})});