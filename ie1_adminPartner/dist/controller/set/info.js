/** layuiAdmin.pro-v1.0.0-beta7 LPPL License By http://www.layui.com/admin/ */
 ;layui.define(function(e){layui.use(["jquery","form","admin","setter"],function(){function e(){s.ajax({url:l+"/merchantShopCategory",type:"get",headers:y,beforeSend:function(){t=layer.load(g,m)},success:function(e){if(layer.close(t),e.status==u)return layer.msg(d),o.exit(),!1;if(200!==e.status)return layer.msg(e.message),!1;for(var a=0;a<e.data.length;a++){var n=e.data[a].name,l=e.data[a].id;s("select[name=shop_category_id]").append("<option value="+l+">"+n+"</option>"),r.render()}h=1},error:function(){layer.msg(c),layer.close(t)}})}var a,t,s=layui.$,r=layui.form,o=layui.admin,n=layui.setter,l=n.baseUrl,i=n.successMsg,c=n.errorMsg,u=n.timeOutCode,d=n.timeOutMsg,y={"Access-Token":layui.data(n.tableName).access_token},g=1,m={shade:.3},f=sessionStorage.getItem("saa_id"),p=sessionStorage.getItem("saa_key"),_=sessionStorage.getItem("saa_category_id"),h=0,v="?key="+p,S=l+"/merchantAppInfo/"+f+v;"1"==_?s(".shop_category_id").hide():(e(),s(".shop_category_id").show()),r.render();var b="";s("#addImgPut").change(function(){var e=this.files[0];if(window.FileReader){var a=new FileReader;a.readAsDataURL(e),a.onloadend=function(e){b=e.target.result,s("#image").attr("src",e.target.result)}}e=null}),s.ajax({url:S,type:"get",async:!1,headers:y,beforeSend:function(){t=layer.load(g,m)},success:function(e){return layer.close(t),e.status==u?(layer.msg(d),o.exit(),!1):200!=e.status?(layer.msg(e.message),!1):(layer.close(a),s("select[name=shop_category_id]").val(e.data.shop_category_id),s("input[name=name]").val(e.data.name),void s("#image").attr("src",e.data.pic_url))},error:function(){layer.msg(c),layer.close(t)}}),r.on("submit(setInfo)",function(){var e={name:s("input[name=name]").val(),pic_url:b,key:p};"2"==_&&(e.shop_category_id=s("select[name=shop_category_id]").val()),console.log(e),s.ajax({url:S,data:e,type:"put",async:!1,headers:y,beforeSend:function(){t=layer.load(g,m)},success:function(e){return layer.close(t),e.status==u?(layer.msg(d),o.exit(),!1):200!=e.status?(layer.msg(c),!1):(layer.msg(i.put),void layer.close(a))},error:function(){layer.msg(c),layer.close(t)}})})}),e("set/info",{})});