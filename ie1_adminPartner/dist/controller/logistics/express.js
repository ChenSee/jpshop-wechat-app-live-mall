/** layuiAdmin.pro-v1.0.0-beta7 LPPL License By http://www.layui.com/admin/ */
 ;layui.define(function(e){layui.use(["table","jquery","form","admin","setter"],function(){function e(e){o.ajax({url:c+"/merchantPost"+S,type:"get",headers:g,beforeSend:function(){a=layer.load(h,v)},success:function(t){if(t.status==p)return layer.msg(f),d.exit(),!1;if(layer.close(a),200!==t.status)return layer.msg(t.message),!1;for(var s=0;s<t.data.length;s++){var r=t.data[s].name,l=t.data[s].id;if(e){var n="";e==l&&(n=" selected "),o("select[name=unfixedSelects]").append("<option value="+l+n+">"+r+"</option>")}else o("select[name=unfixedSelects]").append("<option value="+l+">"+r+"</option>");i.render()}T=1},error:function(){layer.msg(y),layer.close(a)}})}var t,a,s,r,l,n=layui.table,o=layui.$,i=layui.form,d=layui.admin,u=layui.setter,c=u.baseUrl,m=u.successMsg,y=u.errorMsg,p=u.timeOutCode,f=u.timeOutMsg,g={"Access-Token":layui.data(u.tableName).access_token},h=1,v={shade:.3},x=10,_=[10,20,30],b=sessionStorage.getItem("saa_key");sessionStorage.removeItem("expressEdit"),sessionStorage.removeItem("expressId");var k=c+"/merchantShopExpressTemplate",S="?key="+b,w=[{field:"name",title:"模板名称",width:"20%"},{field:"type",title:"计费方式",width:"20%",templet:"#typeTpl"},{field:"status",title:"状态",width:"20%",templet:"#statusTpl"},{field:"create_time",title:"创建时间",width:"20%"},{field:"operations",title:"操作",toolbar:"#operations",width:"20%"}],T=0;i.on("submit(showAdd)",function(){if(o("#add_edit_form")[0].reset(),o("input[name='add_edit_status']").prop("checked",!0),o("input[name='app_id']:eq(0)").prop("checked",!0),i.render(),l="post",T){var a=document.getElementById("unfixedSelects");a.options[0].selected=!0}else e(0);t=layer.open({type:1,title:"新增",content:o("#add_edit_form"),shade:0,offset:"100px",area:["400px","auto"]})}),i.on("submit(sub)",function(){var e,n=0,i=k;o("input[name=add_edit_status]:checked").val()&&(n=1),"post"==l?s=m.post:"put"==l&&(i=k+"/"+r,s=m.put),e={name:o("input[name=name]").val(),category_id:o("select[name=category_name]").val(),detail_info:o("textarea[name=detail_info]").val(),type:o("input[name=applicationType]:checked").val(),status:n,key:b},o.ajax({url:i,data:e,type:l,async:!1,headers:g,beforeSend:function(){a=layer.load(h,v)},success:function(e){return e.status==p?(layer.msg(f),d.exit(),!1):(layer.close(a),200!=e.status?(layer.msg(e.message),!1):(layer.msg(s),layer.close(t),o("#add_edit_form")[0].reset(),void I.reload()))},error:function(){layer.msg(y),layer.close(a)}})}),n.on("tool(pageTable)",function(e){var t=e.data,s=e.event;return r=t.id,"edit"===s?(sessionStorage.setItem("expressId",r),location.hash="/logistics/add"):void("del"===s?layer.confirm("确定要删除这条数据么?",function(s){layer.close(s),o.ajax({url:k+"/"+t.id,data:{key:b},type:"delete",async:!1,headers:g,beforeSend:function(){a=layer.load(h,v)},success:function(t){return t.status==p?(layer.msg(f),d.exit(),!1):(layer.close(a),200!=t.status?(layer.msg(t.message),!1):(layer.msg(m["delete"]),void e.del()))},error:function(){layer.msg(y),layer.close(a)}})}):layer.msg(y))});var I=n.render({elem:"#pageTable",url:k+S,page:!0,limit:x,limits:_,loading:!0,cols:[w],response:{statusName:"status",statusCode:"200",dataName:"data"},headers:g,done:function(e){return e.status==p?(layer.msg(f),d.exit(),!1):200!=e.status?(layer.msg(e.message),!1):void 0}});i.on("submit(find)",function(e){I.reload({where:{searchName:e.field.searchName},page:{curr:1}})}),i.on("switch(statusTpl)",function(e){var s=e.elem.checked?1:0;o.ajax({url:k+"/"+this.value,type:"put",async:!1,data:{status:s,key:b},headers:g,success:function(e){return e.status==p?(layer.msg(f),d.exit(),!1):(layer.close(a),200!=e.status?(layer.msg(e.message),!1):(layer.msg(m.put),void layer.close(t)))},error:function(){layer.msg(y),layer.close(a)},beforeSend:function(){a=layer.load(h,v)}})})}),e("logistics/express",{})});