/** layuiAdmin.pro-v1.0.0-beta7 LPPL License By http://www.layui.com/admin/ */
 ;function addImg(e,a){return'<div class="layui-col-md2 choose_top">\n<input class="checkbox The_selected" type="checkbox" name="del_img" value="'+e+'" style="display: none;">\n<img class="selected_img" style="" src="'+a+'" />\n</div>'}layui.define(function(e){layui.use(["table","jquery","form","admin","setter","element","laypage"],function(){function e(e){i.ajax({url:b+"?type=image&page="+e,type:"get",async:!1,headers:y,beforeSend:function(){n=layer.load(h,f)},success:function(e){if(layer.close(n),e.status==m)return layer.msg(g),s.exit(),!1;if(200!=e.status)return layer.msg(e.message),!1;w=e.data.total_count;var a=e.data.item,t=a.length;if(t>0){i(".images").empty();for(var l=0;l<t;l++)i(".images").append(addImg(a[l].media_id,a[l].url))}i(".page1").show(),i(".page2").hide()},error:function(){layer.msg(d),layer.close(n)}})}function a(a,t){i.ajax({url:b,data:t,type:"post",async:!1,headers:y,beforeSend:function(){n=layer.load(h,f)},success:function(t){return layer.close(n),t.status==m?(layer.msg(g),s.exit(),!1):200!=t.status?(layer.msg(t.message),!1):void("image"==a?e(1):"news"==a&&console.log(t))},error:function(){layer.msg(d),layer.close(n)}})}function t(a){"1"==a?e(1):"2"==a&&(i(".page1").hide(),i(".page2").show())}var n,i=layui.$,l=layui.form,s=layui.admin,r=layui.setter,u=r.baseUrl,o=layui.element,c=layui.laypage,d=r.errorMsg,m=r.timeOutCode,g=r.timeOutMsg,y={"Access-Token":layui.data(r.tableName).access_token},h=1,f={shade:.3},p=18,_=[18,36,48],b=u+"/merchantWechatMedia",v="",w=0,k=[];i("#addImgPut").change(function(){k=[];for(var e=this.files,t=e.length,n=0;n<t;n++)if(window.FileReader){var i=e[n],l=new FileReader;l.readAsDataURL(i),l.onloadend=function(e){k.push(e.target.result);var t="image",n={type:t,pic:e.target.result};a(t,n)}}e=null}),e(1),i(document).on("click",".mul_del_btn",function(){i(this).hide(),i(".mul_del_div").show(),i("input[name=del_img]").show()}),i(document).on("click",".mul_del_cancel",function(){i(".mul_del_btn").show(),i(this).parent().hide(),i("input[name=del_img]").hide()}),i(document).on("click",".mul_del",function(){i(".mul_del_btn").show(),i(this).parent().hide(),i("input[name=del_img]").hide();var a=[];i("input[name=del_img]:checked").each(function(){a.push(this.value)}),i.ajax({url:b,data:{media_id:a},type:"delete",async:!1,headers:y,beforeSend:function(){n=layer.load(h,f)},success:function(a){return layer.close(n),a.status==m?(layer.msg(g),s.exit(),!1):200!=a.status?(layer.msg(a.message),!1):(layer.msg("删除成功"),void e(1))},error:function(){layer.msg(d),layer.close(n)}})}),c.render({elem:"page1",count:w,limit:p,limits:_,jump:function(a,t){t||e(a.curr)}}),o.on("tab(tab)",function(){v=this.getAttribute("lay-id"),t(v),l.render()})}),e("wechat/media",{})});